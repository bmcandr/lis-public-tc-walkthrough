== {title_step1}
anchor:sec_step1[{title_step1}]

:ldtconfig-filename: ldt.config.noah36_params

=== Overview

In this step you will learn how to...

* Run LDT
* Perform parameter processing for the Noah-3.6 land surface model (LSM)
* Generate a Noah-3.6 parameter input file to be used in later steps by LIS (and LVT)

NOTE: These testcases were designed to be run in sequential order and later steps require the output generated by earlier steps.

==== Steps to Running LDT

. Compile the LDT source code to generate the LDT executable (see <<sec_setup>>)
. Collect input data needed by LDT
. Modify `ldt.config` file to define runtime configuration settings
. Run the LDT executable
. Examine output

=== Download Input Files

The input files are available on the {url-lis-testcases}[LIS Testcase website]. While within your $WORKING_DIR, download and unpack the compressed tar file containing the inputs for Step 1:

[#download-step1]
[source,bash,subs="attributes"]
----
% curl -O {url-lis-testcase-files}{step1-filename}
% tar -xzf {step1-filename}
----

WARNING: The compressed tar file for this step is approximately 350MB compressed.

In addition to the `LISF/` repository, your `$WORKING_DIR` will now contain the following directory and files:

* `INPUT/`: a directory that will hold parameter and input files needed throughout the testcases
* `{ldtconfig-filename}`: the runtime configuration file read by LDT in this step
* `target_lis_input.nldas.noah36.d01.nc`: the "target" NetCDF file generated by LDT in this step
* `target_ldtlog.0000`: the "target" log generated by LDT in this step
* `target_MaskParamFill.log`: the "target" mask-parameter log generated by LDT in this step

Each of the files beginning with `target` are provided to compare with the output of your run. Use command-line tools such as `diff` and `nccmp` for these comparisons.

==== The LDT Configuration File

The LDT configuration file (`{ldtconfig-filename}`) contains input settings used by LDT to generate input files for LIS. These settings include:

* The LSM of interest (e.g., https://ral.ucar.edu/solutions/products/noah-multiparameterization-land-surface-model-noah-mp-lsm[Noah.3.6])
* The name of the NetCDF-formatted parameter file to be generated which will be used by lis (`lis_input.nldas.noah36.d01.nc`)
* The name of the diagnostic log file (e.g., `ldtlog`)
* The grid projection, domain extents, and spatial resolution to be used by LIS (and LVT)
* Data source settings and paths (e.g., landcover datasets, elevation datasets)
* Additional features of interest (e.g., irrigation settings)

The grid domain selected in the `ldt.config` file will be placed in the NetCDF-formatted parameter file for LIS to read in automatically at run-time. For these testcases we will be using the domain defined below:

[#domain-spec]
[.float-group]
.Testcase domain specification:
--
image::step_1_domain_map.png[width=85%, float="right"]

[cols=".^h,^,^", options="header", frame=none]
[%autowidth]
|===
||Longitude|Latitude
|Lower left|-102.875|34.375
|Upper right|-96.125|39.625
|Resolution|0.25ยบ|0.25ยบ
|===
--

Before continuing, review the contents of the LDT configuration file for our LDT-based NOAH.3.6 parameter test case:

[#cat-ldtconfig]
[source,bash,subs="attributes"]
----
% cat {ldtconfig-filename}
----
 
==== Files Generated by an LDT Parameter Processing Run

The following files are typically generated by an LDT parameter processing run. This type of run is used to create the files required to run LIS.

* `lis_input.d01.nc`
** The NetCDF-formatted model parameter file, which is read into LIS at runtime. `d01` refers to the indexed domain, typically used as "nests" for NASA-Unified WRF simulations.
* `lislog.0000`
** The output diagnostic file that provides runtime messages, including warnings and error messages. This file is useful for verifying successful run completion and troubleshooting unsuccessful runs.
* `MaskParamFill.log`
** This diagnostic file informs of any disagreements between an LSM-based parameter and the landmask, and whether any parameter gridcells were "filled" to agree with the landmask.